<div class="mermaid">
sequenceDiagram
    participant Client
    participant Resource Owner
    participant Authorization Server
    participant Resource Server
    Client->>Resource Owner: Login
    Resource Owner-->>Client: Login Credentials
    Client->>Authorization Server:Get Request
    Note over Client,Authorization Server: https://AUTHORIZATION_AUTHORITY/api/oauth2/authorize \n client_id=${clientID}&response_type=code&redirect_uri=${redirect_uri} Basic Auth Username:Password
    alt Are Credentials Valid
        alt Is Client Registered
            alt is Client ID Valid
                Authorization Server-->>Resource Owner: 200 OK Grant Form {transactionID:Allow:Deny Form Elements}
                Resource Owner->>Authorization Server: Allow
                Authorization Server-->>Client: Redirect : REDIRECT_URI?code=xyz
                Client->>Client Server: GET REDIRECT_URI?code=xyz
                Client Server->>Authorization Server: POST
                Note over Client Server,Authorization Server:  POST https://AUTHORIZATION_AUTHORITY/api/oauth2/token Basic Auth clientID and clientSecret
                Authorization Server-->>Client Server: Auth Token
                Note over Client Server,Authorization Server: access_token, expiry_time, refresh_token
                Client Server-->>Client: Set Auth Cookie or Error Cookie and redirect to dashboard
                Client->>Resource Server: API Calls- Bearer Auth: Auth Token
                Resource Server-->>Client: Data
            else
                Authorization Server-->>Client: 403 Forbidden
            end
        else
            Authorization Server-->>Client: 403 Unauthorized client
        end
    else
        Authorization Server-->>Client: 401 Unauthorized
    end
</div>